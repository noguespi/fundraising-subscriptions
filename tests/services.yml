parameters:
  db:
    driver: pdo_sqlite
    memory: true
  var_path: /tmp

services:
  db.connection:
    class: Doctrine\DBAL\Connection
    factory: [ Doctrine\DBAL\DriverManager, 'getConnection' ]
    arguments: [ '%db%' ]

  db.entity_manager_factory:
    class: WMDE\Fundraising\Store\Factory
    arguments: [ '@db.connection', '%var_path%' ]

  entity_manager:
    class: Doctrine\ORM\EntityManager
    factory: [ '@db.entity_manager_factory', 'getEntityManager' ]
    public: true

  db.installer:
    class: WMDE\Fundraising\Store\Installer
    factory: [ "@db.entity_manager_factory", "newInstaller" ]
    public: true